# 파이썬 특허 연차료 계산 시스템

고객번호를 입력받아 KIPRIS API를 통해 등록특허 정보를 조회하고 연차료를 계산하는 파이썬 애플리케이션입니다.

## 🚀 기능

- **고객번호 기반 등록특허 검색**: KIPRIS API를 활용한 특허 정보 조회
- **연차료 자동 계산**: 2024년 기준 연차료 및 납부 상태 계산
- **상태 판정**: 유효/추납기간/회복기간/만료 상태 자동 판정
- **배치 처리**: 여러 고객번호 동시 처리 지원
- **사용자 친화적 출력**: 깔끔한 콘솔 출력 포맷

## 📋 출력 정보

각 등록특허에 대해 다음 정보를 표시합니다:

### 기본 정보
- 출원번호
- 등록번호  
- 출원인
- 등록날짜
- 발명명칭 (20자까지)

### 연차료 관련 정보
- **해당 연차료 납부마감일**: YYYY-MM-DD 형식
- **해당연차수**: "N년차" 형식
- **해당연차료**: "XXX,XXX원" 형식
- **유효/불납**: "유효", "추납기간", "회복기간", "불납", "만료"
- **차기년도 납부의뢰**: "N년차 XXX,XXX원 (YYYY-MM-DD 마감)"
- **추납기간**: "YYYY-MM-DD ~ YYYY-MM-DD" 또는 "진행중 (YYYY-MM-DD 마감)"
- **회복기간**: "YYYY-MM-DD ~ YYYY-MM-DD" 또는 "진행중 (YYYY-MM-DD 마감)"

## 🛠️ 설치 및 설정

### 1. Python 환경 요구사항
- Python 3.7 이상

### 2. 의존성 설치
```bash
pip install -r requirements.txt
```

**필요한 라이브러리:**
- `requests`: KIPRIS API 통신
- `python-dotenv`: 환경변수 관리

### 3. 환경변수 설정
`.env` 파일을 생성하고 KIPRIS API 정보를 설정:

```env
KIPRIS_API_KEY=your_api_key_here
KIPRIS_API_BASE_URL=http://plus.kipris.or.kr/kipo-api/kipi/patUtiModInfoSearchSevice
```

## 🎯 사용법

### 명령어 실행
```bash
python patent_renewal_calculator.py
```

### 메뉴 선택
1. **단일 고객번호 조회**: 하나의 고객번호로 조회
2. **배치 처리**: 여러 고객번호를 쉼표로 구분하여 동시 처리
3. **CSV 다운로드**: 마지막 조회 결과를 CSV 파일로 저장
4. **종료**: 프로그램 종료

### 예시 실행
```
====================================
📋 특허 연차료 조회 시스템
====================================
고객번호: 120190612244
조회일시: 2025-01-22 15:30:45
====================================

📊 총 3건의 등록특허가 발견되었습니다.

【1】 특허 정보
------------------------------------------------------------
📄 출원번호: 1020190000001
📄 등록번호: 1023456789
👥 출원인: (주)테스트회사
📅 등록날짜: 2021-03-15
💡 발명명칭: 혁신적인 기술 발명...

💰 연차료 관련 정보:
  - 해당 연차료 납부마감일: 2025-03-15
  - 해당연차수: 5년차
  - 해당연차료: 95,000원
  - 유효/불납: 유효
  - 차기년도 납부의뢰: 6년차 95,000원 (2026-03-15 마감)
  - 추납기간: -
  - 회복기간: -

✅ 연차료 조회가 완료되었습니다.
💾 CSV 다운로드를 원하시면 메뉴에서 '3번'을 선택하세요.
```

### CSV 다운로드 기능
조회가 완료된 후 **메뉴에서 3번**을 선택하면:
- 조회된 모든 특허 정보가 CSV 파일로 저장됩니다
- 파일명: `특허연차료현황_{고객번호}_{날짜시간}.csv`
- 저장 위치: 프로그램 실행 폴더
- 인코딩: UTF-8 with BOM (한글 호환성)

**CSV 파일 구성:**
- 제목: 특허 연차료 현황 보고서
- 고객 정보: 고객번호, 출원인, 조회일시
- 특허별 상세 정보: 13개 컬럼으로 구성된 표 형식
- Excel 호환: CSV 파일을 Excel에서 바로 열어 볼 수 있습니다

## 🧮 연차료 계산 규칙

### 2024년 기준 연차료 (원)
- 1~3년차: 42,000원
- 4~6년차: 95,000원  
- 7~9년차: 250,000원
- 10~12년차: 500,000원
- 13~15년차: 660,000원
- 16~18년차: 850,000원
- 19~20년차: 1,100,000원

### 상태 판정 기준
- **유효**: 납부 마감일까지 여유가 있음
- **추납기간**: 납부 마감일 후 6개월 이내 (20% 할증료 적용)
- **회복기간**: 추납기간 후 12개월 이내 (회복료 별도)
- **만료**: 회복기간도 초과한 경우

## 📁 프로젝트 구조

```
patent_renewal_calculator.py  # 메인 애플리케이션
requirements.txt             # Python 의존성
README_Python.md            # 이 파일
.env                        # 환경변수 (직접 생성 필요)
```

## 🔧 클래스 구조

- **KiprisAPIClient**: KIPRIS API 통신 및 XML 파싱
- **RenewalFeeCalculator**: 연차료 계산 및 상태 판정 로직
- **PatentRenewalSystem**: 전체 시스템 흐름 관리
- **PatentInfo**: 특허 정보 데이터 클래스
- **RenewalFeeInfo**: 연차료 정보 데이터 클래스

## ⚠️ 주의사항

1. **API 호출 제한**: 과도한 API 호출을 방지하기 위해 배치 처리 시 1초 간격으로 호출
2. **환경변수 필수**: KIPRIS API 키와 Base URL이 반드시 설정되어야 함
3. **고객번호 형식**: 12자리 숫자만 허용
4. **날짜 계산**: 등록일 기준으로 연차수 및 납부 마감일 계산

## 🔄 기존 Node.js 시스템과의 차이점

- **독립 실행**: 웹서버 없이 콘솔에서 직접 실행
- **배치 처리**: 여러 고객번호 동시 처리 지원
- **연차료 계산**: 실제 연차료 금액 및 상태 계산 로직 포함
- **사용자 친화적**: 메뉴 기반 대화형 인터페이스
- **CSV 내보내기**: 조회 결과를 CSV 파일로 자동 생성 (Excel 호환)

## 🆘 문제 해결

### 환경변수 오류
```
❌ 환경변수 설정이 필요합니다:
   KIPRIS_API_KEY와 KIPRIS_API_BASE_URL을 .env 파일에 설정해주세요.
```
→ .env 파일 생성 및 API 정보 설정 확인

### API 호출 오류  
```
❌ API 호출 오류: [오류 메시지]
```
→ 네트워크 연결 및 API 키 유효성 확인

### 고객번호 형식 오류
```
❌ 고객번호는 12자리 숫자여야 합니다.
```
→ 12자리 숫자 형식으로 입력 (예: 120190612244)

---

**제작**: UNIC Patent Office  
**기반**: 기존 Node.js KIPRIS 시스템을 Python으로 재구현